<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="SellPhoneApplication.Views.ProductManagementPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:models="clr-namespace:SellPhoneApplication.Models"
    xmlns:shared="clr-namespace:SellPhoneApplication.Shared"
   
    BackgroundColor="#F0F0F0">

    <Grid RowSpacing="0">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <!--  Header  -->
            <RowDefinition Height="Auto" />

            <RowDefinition Height="Auto" />
            <!--  Title & Add button  -->
            <RowDefinition Height="Auto" />
            <!--  Column Headers  -->
            <RowDefinition Height="*" />
            <!--  Content List  -->
        </Grid.RowDefinitions>


        <shared:HeaderView Grid.Row="0" />


        <!--  Title and Add Button  -->
        <Grid
            Grid.Row="2"
            Padding="80,10"
            ColumnDefinitions="*,Auto"
            VerticalOptions="Center">

            <Label
                FontAttributes="Bold"
                FontSize="24"
                Text="QL sản phẩm"
                TextColor="#212121"
                VerticalOptions="Center" />

            <SearchBar
                Margin="10,0"
                HorizontalOptions="End"
                Placeholder="Tìm kiếm..."
                SearchCommand="{Binding LoadProductsCommand}"
                Text="{Binding SearchValue}"
                VerticalOptions="Center"
                WidthRequest="200" />

            <Button
                Grid.Column="1"
                Padding="10,0"
                BackgroundColor="#FDBA12"
                Clicked="OnAddNewClicked"
                CornerRadius="8"
                FontSize="14"
                Text="Thêm mới"
                TextColor="White" />
        </Grid>


        <!--  Column headers  -->
        <Grid
            Grid.Row="3"
            Margin="0,10,0,10"
            Padding="80,10"
            ColumnDefinitions="*,*,*,*,Auto">
            <Label
                Grid.Column="0"
                FontSize="12"
                Text="Tên sản phẩm"
                TextColor="Gray" />
            <Label
                Grid.Column="1"
                FontSize="12"
                HorizontalTextAlignment="Center"
                Text="Giá"
                TextColor="Gray" />
            <Label
                Grid.Column="2"
                FontSize="12"
                HorizontalTextAlignment="Center"
                Text="RAM"
                TextColor="Gray" />
            <Label
                Grid.Column="3"
                FontSize="12"
                HorizontalTextAlignment="Center"
                Text="Bộ nhớ"
                TextColor="Gray" />
            <Label
                Grid.Column="4"
                FontSize="12"
                HorizontalTextAlignment="End"
                Text="Hành động"
                TextColor="Gray" />
        </Grid>

        <!--  List of phones  -->
        <ScrollView Grid.Row="4" Padding="80,10">
            <CollectionView ItemsSource="{Binding Phones}">
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout ItemSpacing="5" Orientation="Vertical" />
                </CollectionView.ItemsLayout>
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="models:Phone">
                        <Frame
                            Margin="0,0,0,10"
                            Padding="8,16"
                            BackgroundColor="#E0E0E0"
                            BorderColor="White"
                            CornerRadius="8"
                            HasShadow="False">
                            <Grid
                                ColumnDefinitions="*,*,*,*,Auto"
                                RowDefinitions="Auto"
                                VerticalOptions="Center">

                                <!--  Tên + ảnh  -->
                                <HorizontalStackLayout
                                    Grid.Column="0"
                                    Spacing="10"
                                    VerticalOptions="Center">
                                    <Image
                                        Aspect="AspectFill"
                                        HeightRequest="40"
                                        Source="{Binding ImageUrl}"
                                        VerticalOptions="Center"
                                        WidthRequest="40" />
                                    <Label
                                        FontSize="14"
                                        LineBreakMode="TailTruncation"
                                        Text="{Binding Name}"
                                        VerticalOptions="Center" />
                                </HorizontalStackLayout>

                                <!--  Giá  -->
                                <Label
                                    Grid.Column="1"
                                    FontSize="14"
                                    HorizontalTextAlignment="Center"
                                    Text="{Binding Price, StringFormat='{}{0:N0}₫'}"
                                    VerticalOptions="Center" />

                                <!--  RAM  -->
                                <Label
                                    Grid.Column="2"
                                    FontSize="14"
                                    HorizontalTextAlignment="Center"
                                    Text="{Binding Ram, StringFormat='{}{0} GB'}"
                                    VerticalOptions="Center" />

                                <!--  Bộ nhớ  -->
                                <Label
                                    Grid.Column="3"
                                    FontSize="14"
                                    HorizontalTextAlignment="Center"
                                    Text="{Binding Memory, StringFormat='{}{0} GB'}"
                                    VerticalOptions="Center" />

                                <!--  Hành động  -->
                                <HorizontalStackLayout
                                    Grid.Column="4"
                                    HorizontalOptions="End"
                                    VerticalOptions="Center">
                                    <Image
                                        HeightRequest="14"
                                        Source="pencil_icon.png"
                                        WidthRequest="14" />

                                    <Image
                                        Margin="10,0,0,0"
                                        HeightRequest="15"
                                        Source="delete_icon.png"
                                        WidthRequest="15">
                                        <Image.GestureRecognizers>
                                            <TapGestureRecognizer Command="{Binding Source={x:Reference ProductManagementPageView}, Path=BindingContext.DeletePhoneCommand}" CommandParameter="{Binding .}" />
                                        </Image.GestureRecognizers>
                                    </Image>
                                </HorizontalStackLayout>
                            </Grid>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </ScrollView>

    </Grid>
</ContentPage>
